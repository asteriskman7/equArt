<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>equArt Explorer</title>
    <link rel="icon" href="EquArtAvatar.png">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <link rel="stylesheet" href="index.css">
  </head>
  <body>
    <div id='banner'>
      <div id='bannerText'><img id='bannerIcon' src='EquArtAvatar.png'>equArt Explorer</div>
    </div>
    <div id='headerContainer' class='infoBox'>
      <div>Seed:</div><div><input id='inputSeed' class="headerInput" type='number'><button id='brnd'>&#127922;</button></div>
        <div class='bdiv'><button id='bgenEqu'>Gen from seed</button></div>
      <div>Equation:</div><div><textarea id='inputEqu' class="headerInput" type='entry' spellcheck="false"></textarea></div>
        <div class='bdiv'><button id='bgenImg'>Gen from equation</button></div>
      <div>Color:</div><div><input id='inputCMin' class="headerInput" type='range' min="0" max="360"></div>
        <div></div>
      <div>Range:</div><div><input id='inputCRange' class='headerInput' type='range' min='0' max='720'></div>
        <div id='colorRange'></div>
    </div>
    <div id='msgDiv' class='infoBox'>
    </div>
    <canvas id='cmain' width='512' height='512'></canvas>
    <div id='howToUse' class='infoBox'>
      <h2>Instructions</h2>
      <p>This tool is a companion to the <a href='https://botsin.space/@EquArt'>EquArt generative art bot</a>.</p>
      <p>You can generate an image from a seed (either manually entered or randomly generated) or you can enter
      your own equation. You can also adjust the color range used.</p>
      <p>When creating your own equation there are a few rules to follow:</p>
      <ul>
        <li>You must use parenthesis around every binary operator and its operands.</li>
        <li>The only valid operands are <code>x</code> and <code>y</code> which represent the x and y location on the image in pixels.</li>
        <li>The supported unary operators are: 
          <dl>
            <dt><code>sin()</code></dt>
            <dd>Sine with argument in radians.</dd>
            <dt><code>asin()</code></dt>
            <dd>Arcsine with result in radians.</dd>
            <dt><code>tan()</code></dt>
            <dd>Tangent with argument in radians.</dd>
            <dt><code>ln()</code></dt>
            <dd>Natural logarithm.</dd>
          </dl>
        </li>
        <li>The supported binary operators are:
          <dl>
            <dt><code>&lt;</code></dt>
            <dd>Less than. Returns 0 or 1.</dd>
            <dt><code>+</code></dt>
            <dd>Addition.</dd>
            <dt><code>-</code></dt>
            <dd>Subtraction.</dd>
            <dt><code>*</code></dt>
            <dd>Multiplication.</dd>
            <dt><code>/</code></dt>
            <dd>Division.</dd>
            <dt><code>**</code></dt>
            <dd>Exponentiation.</dd>
            <dt><code>^</code></dt>
            <dd>XOR.</dd>
          </dl>
        </li>
      </ul>
      <p>If a problem occurs when parsing your equation, an error will be displayed
      that shows the parsing result so you can try to understand your error.
    </div>
    <div id='details' class='infoBox'>
      <h2><a id="ImageGenerationDetails">Image generation details</a></h2>
      <ol>
        <li class='liigd'>
          <h3>Equation generation</h3>
          Functions start out as a single place holder symbol. 
          Place holder symbols are repeatedly replaced by equation phrases.
          Some equation phrases only contain an operand but others contain operators and
          additional place holder symbols. Equation phrases are selected randomly but are
          weighted so some are selected more frequently than others. Additionally,
          the weighting changes depending on the equation length to try to avoid 
          very long and very short equations. Equation generation is complete
          when no place holder symbols remain in the equation.
          <p>The random number
          generator used is seeded and returns the same sequence given the same seed
          so equation generation is deterministic based on the seed.
        </li>
        <li class='liigd'>
          <h3>Equation selection</h3>
          In order to avoid overly simple or entirely random images, the complexity 
          of the image generated by the generated equation is measured. 
          If the complexity is either too high or too low
          the equation is discarded and another one generated.
          <p>To estimate the equation complexity, the equation is evaluated 
          and the resulting image is compressed. It is assumed that the compression ratio
          implies something about the image complexity. 
          <p>The high and low thresholds used for equation selection were emperically
          selected. However, the line between beauty and randomness is fine and the
          high threshold was selected to try and avoid rejecting attractive images
          at the expense of sometimes accepting random looking images.
        </li>
        <li class='liigd'>
          <h3>Image rendering</h3>
          Before rendering the image, a base color and color range are randomly chosen as the
          color palette.
          <p>For every pixel in the image, the selected equation is evaluated with the current
          pixel location used for the x, y operands in the equation. The resulting 
          value is mapped into the range [0:360) via the modulus operator and then linearlly 
          mapped into the color palette previously selected. Any Infinities or errors 
          generated when evaluating the equation are mapped to the palette's base color.
        </li>
      </ol>
    </div>
    <script src="EquArtImg.js"></script>
    <script src="index.js"></script>
  </body>
</html>
